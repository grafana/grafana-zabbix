<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Functions - Grafana-Zabbix Documentation</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  <link href="../../css/custom.css" rel="stylesheet">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Functions";
    var mkdocs_page_input_path = "reference/functions.md";
    var mkdocs_page_url = "/grafana-zabbix/reference/functions/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/sql.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Grafana-Zabbix Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <span class="caption-text">Project</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../..">About Grafana-Zabbix</a>
                </li>
                <li class="">
                    
    <a class="" href="../../features/">Feature Highlights</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Installation</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../installation/">Installation</a>
                </li>
                <li class="">
                    
    <a class="" href="../../installation/run_from_master/">Building from sources</a>
                </li>
                <li class="">
                    
    <a class="" href="../../installation/upgrade/">Upgrade</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Configuration</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../configuration/">Configuration</a>
                </li>
                <li class="">
                    
    <a class="" href="../../configuration/direct_db_datasource/">Direct DB Connection Configuration</a>
                </li>
                <li class="">
                    
    <a class="" href="../../configuration/provisioning/">Provisioning</a>
                </li>
                <li class="">
                    
    <a class="" href="../../configuration/troubleshooting/">Troubleshooting</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">User Guides</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../guides/gettingstarted/">Getting Started</a>
                </li>
                <li class="">
                    
    <a class="" href="../../guides/templating/">Templating</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Reference</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../datasource-zabbix/">Zabbix Datasource</a>
                </li>
                <li class="">
                    
    <a class="" href="../panel-triggers/">Triggers Panel</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">Functions</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#functions-reference">Functions reference</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#functions-variables">Functions Variables</a></li>
        
            <li><a class="toctree-l4" href="#transform">Transform</a></li>
        
            <li><a class="toctree-l4" href="#aggregate">Aggregate</a></li>
        
            <li><a class="toctree-l4" href="#filter">Filter</a></li>
        
            <li><a class="toctree-l4" href="#trends">Trends</a></li>
        
            <li><a class="toctree-l4" href="#time">Time</a></li>
        
            <li><a class="toctree-l4" href="#alias">Alias</a></li>
        
            <li><a class="toctree-l4" href="#special">Special</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../alerting/">Alerting</a>
                </li>
                <li class="">
                    
    <a class="" href="../direct-db-connection/">Direct DB Connection</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Grafana-Zabbix Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Reference &raquo;</li>
        
      
    
    <li>Functions</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/alexanderzobnin/grafana-zabbix/blob/docs/docs/sources/reference/functions.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="functions-reference">Functions reference</h1>
<h2 id="functions-variables">Functions Variables</h2>
<p>There are some built-in template variables available for using in functions:</p>
<ul>
<li><code>$__range_ms</code> - panel time range in ms</li>
<li><code>$__range_s</code> - panel time range in seconds</li>
<li><code>$__range</code> - panel time range, string representation (<code>30s</code>, <code>1m</code>, <code>1h</code>)</li>
<li><code>$__range_series</code> - invoke function over all series values</li>
</ul>
<p>Examples:</p>
<pre><code>groupBy($__range, avg)
percentile($__range_series, 95) - 95th percentile over all values
</code></pre>

<hr />
<h2 id="transform">Transform</h2>
<h3 id="groupby"><em>groupBy</em></h3>
<pre><code>groupBy(interval, function)
</code></pre>

<p>Takes each timeseries and consolidate its points fallen in the given <em>interval</em> into one point using <em>function</em>, which can be one of: <em>avg</em>, <em>min</em>, <em>max</em>, <em>median</em>.</p>
<p>Examples:</p>
<pre><code>groupBy(10m, avg)
groupBy(1h, median)
</code></pre>

<hr />
<h3 id="scale"><em>scale</em></h3>
<pre><code>scale(factor)
</code></pre>

<p>Takes timeseries and multiplies each point by the given <em>factor</em>.</p>
<p>Examples:</p>
<pre><code>scale(100)
scale(0.01)
</code></pre>

<hr />
<h3 id="delta"><em>delta</em></h3>
<pre><code>delta()
</code></pre>

<p>Converts absolute values to delta. This function just calculate difference between values. For the per-second
calculation use <code>rate()</code>.</p>
<hr />
<h3 id="rate"><em>rate</em></h3>
<pre><code>rate()
</code></pre>

<p>Calculates the per-second rate of increase of the time series. Resistant to counter reset. Suitable for converting of
growing counters into the per-sercond rate.</p>
<hr />
<h3 id="movingaverage"><em>movingAverage</em></h3>
<pre><code>movingAverage(windowSize)
</code></pre>

<p>Graphs the moving average of a metric over a fixed number of past points, specified by <code>windowSize</code> param.</p>
<p>Examples:</p>
<pre><code>movingAverage(60)
calculates moving average over 60 points (if metric has 1 second resolution it matches 1 minute window)
</code></pre>

<hr />
<h3 id="exponentialmovingaverage"><em>exponentialMovingAverage</em></h3>
<pre><code>exponentialMovingAverage(windowSize)
</code></pre>

<p>Takes a series of values and a window size and produces an exponential moving average utilizing the following formula:<br />
<code>ema(current) = constant * (Current Value) + (1 - constant) * ema(previous)</code></p>
<p>The Constant is calculated as:<br />
<code>constant = 2 / (windowSize + 1)</code></p>
<p>If windowSize &lt; 1 (0.1, for instance), Constant wouldn't be calculated and will be taken directly from windowSize
(Constant = windowSize).</p>
<p>It's a bit tricky to graph EMA from the first point of series (not from Nth = windowSize). In order to do it,
plugin should fetch previous N points first and calculate simple moving average for it. To avoid it, plugin uses this
hack: assume, previous N points have the same average values as first N (windowSize). So you should keep this fact
in mind and don't rely on first N points interval.</p>
<p>Examples:</p>
<pre><code>movingAverage(60)
calculates moving average over 60 points (if metric has 1 second resolution it matches 1 minute window)
</code></pre>

<hr />
<h3 id="percentile"><em>percentile</em></h3>
<pre><code>percentile(interval, N)
</code></pre>

<p>Takes a series of values and a window size and consolidate all its points fallen in the given <em>interval</em> into one point by Nth percentile.</p>
<p>Examples:</p>
<pre><code>percentile(1h, 99)
percentile($__range_series, 95) - 95th percentile over all series values
</code></pre>

<hr />
<h3 id="removeabovevalue"><em>removeAboveValue</em></h3>
<pre><code>removeAboveValue(N)
</code></pre>

<p>Replaces series values with <code>null</code> if value &gt; N</p>
<p>Examples:</p>
<pre><code>removeAboveValue(1)
</code></pre>

<hr />
<h3 id="removebelowvalue"><em>removeBelowValue</em></h3>
<pre><code>removeBelowValue(N)
</code></pre>

<p>Replaces series values with <code>null</code> if value &lt; N</p>
<hr />
<h3 id="transformnull"><em>transformNull</em></h3>
<pre><code>transformNull(N)
</code></pre>

<p>Replaces <code>null</code> values with N</p>
<hr />
<h2 id="aggregate">Aggregate</h2>
<h3 id="aggregateby"><em>aggregateBy</em></h3>
<pre><code>aggregateBy(interval, function)
</code></pre>

<p>Takes all timeseries and consolidate all its points fallen in the given <em>interval</em> into one point using <em>function</em>, which can be one of: <em>avg</em>, <em>min</em>, <em>max</em>, <em>median</em>.</p>
<p>Examples:</p>
<pre><code>aggregateBy(10m, avg)
aggregateBy(1h, median)
</code></pre>

<hr />
<h3 id="sumseries"><em>sumSeries</em></h3>
<pre><code>sumSeries()
</code></pre>

<p>This will add metrics together and return the sum at each datapoint. This method required interpolation of each timeseries so it may cause high CPU load. Try to combine it with <em>groupBy()</em> function to reduce load.</p>
<hr />
<h3 id="percentileagg"><em>percentileAgg</em></h3>
<pre><code>percentileAgg(interval, N)
</code></pre>

<p>Takes all timeseries and consolidate all its points fallen in the given <em>interval</em> into one point by Nth percentile.</p>
<p>Examples:</p>
<pre><code>percentileAgg(1h, 99)
percentileAgg($__range_series, 95) - 95th percentile over all values
</code></pre>

<hr />
<h3 id="average"><em>average</em></h3>
<pre><code>average(interval)
</code></pre>

<p><strong>Deprecated</strong>, use <code>aggregateBy(interval, avg)</code> instead.</p>
<hr />
<h3 id="min"><em>min</em></h3>
<pre><code>min(interval)
</code></pre>

<p><strong>Deprecated</strong>, use <code>aggregateBy(interval, min)</code> instead.</p>
<hr />
<h3 id="max"><em>max</em></h3>
<pre><code>max(interval)
</code></pre>

<p><strong>Deprecated</strong>, use <code>aggregateBy(interval, max)</code> instead.</p>
<hr />
<h2 id="filter">Filter</h2>
<h3 id="top"><em>top</em></h3>
<pre><code>top(N, value)
</code></pre>

<p>Returns top N series, sorted by <em>value</em>, which can be one of: <em>avg</em>, <em>min</em>, <em>max</em>, <em>median</em>.</p>
<p>Examples:</p>
<pre><code>top(10, avg)
top(5, max)
</code></pre>

<hr />
<h3 id="bottom"><em>bottom</em></h3>
<pre><code>bottom(N, value)
</code></pre>

<p>Returns bottom N series, sorted by <em>value</em>, which can be one of: <em>avg</em>, <em>min</em>, <em>max</em>, <em>median</em>.</p>
<p>Examples:</p>
<pre><code>bottom(5, avg)
</code></pre>

<hr />
<h2 id="trends">Trends</h2>
<h3 id="trendvalue"><em>trendValue</em></h3>
<pre><code>trendValue(valueType)
</code></pre>

<p>Specifying type of trend value returned by Zabbix when trends are used (avg, min or max).</p>
<hr />
<h2 id="time">Time</h2>
<h3 id="timeshift"><em>timeShift</em></h3>
<pre><code>timeShift(interval)
</code></pre>

<p>Draws the selected metrics shifted in time. If no sign is given, a minus sign ( - ) is implied which will shift the metric back in time. If a plus sign ( + ) is given, the metric will be shifted forward in time.
Examples:</p>
<pre><code>timeShift(24h)  - shift metric back in 24h hours
timeShift(-24h) - the same result as for timeShift(24h)
timeShift(+1d)  - shift metric forward in 1 day
</code></pre>

<hr />
<h2 id="alias">Alias</h2>
<p>Following template variables available for using in <code>setAlias()</code> and <code>replaceAlias()</code> functions:</p>
<ul>
<li><code>$__zbx_item</code>, <code>$__zbx_item_name</code> - item name</li>
<li><code>$__zbx_item_key</code> - item key</li>
<li><code>$__zbx_host_name</code> - visible name of the host</li>
<li><code>$__zbx_host</code> - technical name of the host</li>
</ul>
<p>Examples:</p>
<pre><code>setAlias($__zbx_host_name: $__zbx_item) -&gt; backend01: CPU user time
setAlias(Item key: $__zbx_item_key) -&gt; Item key: system.cpu.load[percpu,avg1]
setAlias($__zbx_host_name) -&gt; backend01
</code></pre>

<h3 id="setalias"><em>setAlias</em></h3>
<pre><code>setAlias(alias)
</code></pre>

<p>Returns given alias instead of the metric name.</p>
<p>Examples:</p>
<pre><code>setAlias(load)
</code></pre>

<hr />
<h3 id="setaliasbyregex"><em>setAliasByRegex</em></h3>
<pre><code>setAliasByRegex(regex)
</code></pre>

<p>Returns part of the metric name matched by regex.</p>
<p>Examples:</p>
<pre><code>setAlias(Zabbix busy [a-zA-Z]+)
</code></pre>

<hr />
<h3 id="replacealias"><em>replaceAlias</em></h3>
<pre><code>replaceAlias(pattern, newAlias)
</code></pre>

<p>Replace metric name using pattern. Pattern is regex or regular string. If regex is used, following special replacement patterns are supported:</p>
<table>
<thead>
<tr>
<th>Pattern</th>
<th>Inserts</th>
</tr>
</thead>
<tbody>
<tr>
<td>$$</td>
<td>Inserts a "$".</td>
</tr>
<tr>
<td>$&amp;</td>
<td>Inserts the matched substring.</td>
</tr>
<tr>
<td>$`</td>
<td>Inserts the portion of the string that precedes the matched substring.</td>
</tr>
<tr>
<td>$'</td>
<td>Inserts the portion of the string that follows the matched substring.</td>
</tr>
<tr>
<td>$n</td>
<td>Where n is a non-negative integer less than 100, inserts the nth parenthesized submatch string, provided the first argument was a RegExp object.</td>
</tr>
</tbody>
</table>
<p>For more details see <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/replace">String.prototype.replace()</a> function.</p>
<p>Examples:</p>
<pre><code>CPU system time
replaceAlias(/CPU (.*) time/, $1) -&gt; system

backend01: CPU system time
replaceAlias(/CPU (.*) time/, $1) -&gt; backend01: system

backend01: CPU system time
replaceAlias(/.*CPU (.*) time/, $1) -&gt; system

backend01: CPU system time
replaceAlias(/(.*): CPU (.*) time/, $1 - $2) -&gt; backend01 - system
</code></pre>

<hr />
<h2 id="special">Special</h2>
<h3 id="consolidateby"><em>consolidateBy</em></h3>
<pre><code>consolidateBy(consolidationFunc)
</code></pre>

<p>When a graph is drawn where width of the graph size in pixels is smaller than the number of datapoints to be graphed, plugin consolidates the values to to prevent line overlap. The consolidateBy() function changes the consolidation function from the default of average to one of <code>sum</code>, <code>min</code>, <code>max</code> or <code>count</code>.</p>
<p>Valid function names are <code>sum</code>, <code>avg</code>, <code>min</code>, <code>max</code> and <code>count</code>.</p>
<hr />
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../alerting/" class="btn btn-neutral float-right" title="Alerting">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../panel-triggers/" class="btn btn-neutral" title="Triggers Panel"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>Copyright &copy; 2015-2020, Alexander Zobnin</p>
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/alexanderzobnin/grafana-zabbix/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../panel-triggers/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../alerting/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>

</body>
</html>
